#  ------------------------------------------------------------------------------------------
#  Copyright (c) Microsoft Corporation. All rights reserved.
#  Licensed under the MIT License (MIT). See LICENSE in the repo root for license information.
#  ------------------------------------------------------------------------------------------

"""
THIS FILE IS AUTO GENERATED. DO NOT EDIT THIS, EDIT THE TEMPLATE.

Simple 'hello world' script to elevate to AML using our `submit_to_azure_if_needed` function.
"""
import logging
import os
import pkg_resources
import sys
from argparse import ArgumentParser
from pathlib import Path

from health.azure.himl import submit_to_azure_if_needed, WORKSPACE_CONFIG_JSON

hi_ml_dist = pkg_resources.get_distribution("hi-ml")
print(f"hi_ml_dist, location: {hi_ml_dist.location}, version: {hi_ml_dist.version}")

here = Path(__file__).parent.resolve()


def main() -> None:
    """
    Write out the given message, in an AzureML 'experiment' if required.
    """
    _ = submit_to_azure_if_needed(
        entry_script={{ entry_script }},
        compute_cluster_name={{ compute_cluster_name }},
        conda_environment_file={{ conda_environment_file }},
        aml_workspace=None,
        workspace_config_path={{ workspace_config_path }},
        snapshot_root_directory=here,
        environment_variables={{ environment_variables }},
        wait_for_completion={{ wait_for_completion }},
        wait_for_completion_show_output={{ wait_for_completion_show_output }})

    parser = ArgumentParser()
    parser.add_argument("-m", "--message", type=str, required=True, help="The message to print out")
    args = parser.parse_args()

    print(f"The message was: {args.message}")


if __name__ == "__main__":
    main()

